dsl_version: 0.1.0
service:
  name: redis-slave
  kind: DaemonSet
  ports:
    - {{ redis.ports.server }}
  containers:
    - name: redis-slave
      image: redis
      probes:
        readiness: "true"
        liveness:
          command: "true"
          type: "exec"
      daemon:
        files:
          - redis-conf
        command: >
                redis-server /etc/redis/redis.conf
                --slaveof {{ address('redis') }} {{ redis.ports.server.cont }}
        dependencies:
          - redis
      volumes:
      - name: redis-logs
        path: "/var/log/ccp/redis"
        type: host
        readOnly: False
      - name: redis-data
        path: "/var/lib/redis"
        type: host
        readOnly: False
files:
  redis-conf:
    path: /etc/redis/redis.conf
    content: redis.conf.j2
